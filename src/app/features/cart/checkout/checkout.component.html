<div class="checkout-container">
  <h1>Checkout</h1>

  <div class="checkout-content">
    <mat-card class="order-items-card">
      <h2>Order Items</h2>
      <div class="order-item" *ngFor="let item of cartItems">
        <img [src]="item.product.imageUrl || 'assets/product/product-placeholder.png'" 
             [alt]="item.product.name"
             class="item-image">
        <div class="item-details">
          <h3>{{ item.product.name }}</h3>
          <p>{{ item.product.categoryName }}</p>
        </div>
        <div class="item-quantity">
          <span>Qty: {{ item.quantity }}</span>
        </div>
        <div class="item-price">
          <span>{{ item.product.price | currency }}</span>
        </div>
      </div>
    </mat-card>

    <mat-card class="checkout-form-card">
      <h2>Order Summary</h2>
      
      <form [formGroup]="checkoutForm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Discount Code (Optional)</mat-label>
          <input matInput formControlName="discountCode" placeholder="SAVE10">
          <mat-icon matPrefix>local_offer</mat-icon>
          <mat-hint>Try: SAVE10, SAVE20, or FLAT50</mat-hint>
        </mat-form-field>
      </form>

      <div class="order-summary">
        <div class="summary-row">
          <span>Subtotal:</span>
          <span>{{ cartTotal | currency }}</span>
        </div>
        <div class="summary-row total">
          <span>Total:</span>
          <span>{{ cartTotal | currency }}</span>
        </div>
      </div>

      <button mat-raised-button color="primary" class="place-order-btn"
              (click)="placeOrder()"
              [disabled]="(loading$ | async) || cartItems.length === 0">
        <span *ngIf="!(loading$ | async)">Place Order</span>
        <mat-spinner *ngIf="loading$ | async" diameter="20"></mat-spinner>
      </button>

      <p class="checkout-note">
        <mat-icon>info</mat-icon>
        Your order will be confirmed immediately after placement.
      </p>
    </mat-card>
  </div>
</div>